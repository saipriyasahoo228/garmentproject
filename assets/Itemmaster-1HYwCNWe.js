import{r as n,j as t,J,K as u,M as k,O as I,Q as S,S as E,a5 as A,a6 as v,a7 as w,a8 as T,V,W as O,X,Y,Z,_ as q,$ as o,a0 as G,a1 as L,a2 as ee,a3 as te}from"./index-Cu_X65SH.js";import{a as l}from"./auth-DZlOdSqG.js";import{C as ae}from"./CircularProgress-DGWuXveq.js";function oe(){const[s,i]=n.useState({item_name:"",item_code:"",category_name:"",sub_category_name:"",hsn_code:"",unit_price:"",stock_quantity:"",description:""}),[c,m]=n.useState([]),[j,R]=n.useState([]),[f,W]=n.useState([]),[h,C]=n.useState({add:!1}),[B,g]=n.useState(!1),[d,_]=n.useState(null),[U,$]=n.useState(null),[K,p]=n.useState(!1),y=n.useRef([]);n.useEffect(()=>{const e=async()=>{try{const r=await l.get("/api/user/items/");m(r.data.data)}catch(r){console.error("Error fetching items:",r)}},a=async()=>{try{const r=await l.get("/api/user/categories/");R(r.data)}catch(r){console.error("Error fetching categories:",r)}};e(),a()},[]);const M=async e=>{const a=e.target.value;i({...s,category_name:a,sub_category_name:""});try{const r=await l.get(`/api/user/subcategories/${a}/`);W(r.data)}catch(r){console.error("Error fetching subcategories:",r)}},b=e=>{i({...s,[e.target.name]:e.target.value})},P=()=>{g(!0),_(null),i({item_name:"",item_code:"",category_name:"",sub_category_name:"",hsn_code:"",unit_price:"",stock_quantity:"",description:""})},x=()=>{g(!1)},F=async e=>{e.preventDefault(),C({...h,add:!0});try{if(d!==null){const a=await l.put(`/api/user/items/${s.item_code}/`,s),r=[...c];r[d]={...c[d],...s},m(r),alert(a.data.message)}else{const a=await l.post("/api/user/items/",s);m([...c,a.data]),alert(a.data.message)}}catch(a){console.error("Error adding/updating item:",a),alert("Error adding/updating item:",a)}finally{C({...h,add:!1}),x()}},H=e=>{_(e),i(c[e]),g(!0)},N=e=>{$(e),p(!0),i(c[e])},D=()=>{p(!1)},Q=async()=>{try{await l.delete(`/api/user/items/${s.item_code}/`);const e=c.filter((a,r)=>r!==U);m(e),alert("Company deleted successfully!")}catch(e){console.error("Error deleting item:",e)}finally{p(!1)}},z=(e,a)=>{if(e.key==="Enter"){e.preventDefault();const r=a+1;y.current[r]&&y.current[r].focus()}};return t.jsxs(J,{sx:{maxWidth:"100%",padding:2},children:[t.jsx(u,{variant:"contained",color:"secondary",onClick:P,children:"Add Item"}),t.jsxs(k,{open:B,onClose:x,children:[t.jsx(I,{style:{backgroundColor:"#f9dff5"},children:d!==null?"Edit Item Details":"Add Item Details"}),t.jsx(S,{style:{backgroundColor:"#f9dff5"},children:t.jsx(E,{sx:{padding:"10px",backgroundColor:"#f9dff5"},elevation:0,children:t.jsxs("form",{children:[t.jsxs(A,{fullWidth:!0,margin:"normal",required:!0,children:[t.jsx(v,{children:"Category"}),t.jsx(w,{value:s.category_name,name:"category_name",onChange:M,label:"Category",children:Array.isArray(j)&&j.map((e,a)=>t.jsx(T,{value:e.category_name,children:e.category_name},e.id))})]}),t.jsxs(A,{fullWidth:!0,margin:"normal",required:!0,children:[t.jsx(v,{children:"Sub-Category"}),t.jsx(w,{value:s.sub_category_name,name:"sub_category_name",onChange:b,label:"Sub-Category",disabled:!s.category_name,children:Array.isArray(f)&&f.map(e=>t.jsx(T,{value:e.name,children:e.name},e.id))})]}),Object.keys(s).filter(e=>e!=="category_name"&&e!=="sub_category_name").map((e,a)=>t.jsx(V,{fullWidth:!0,label:e.replace("_"," ").toUpperCase(),name:e,value:s[e],onChange:b,margin:"normal",inputRef:r=>y.current[a]=r,onKeyDown:r=>z(r,a),type:["unit_price","stock_quantity"].includes(e)?"number":"text"},e))]})})}),t.jsxs(O,{style:{backgroundColor:"#f9dff5"},children:[t.jsx(u,{onClick:x,color:"error",children:"Cancel"}),t.jsx(u,{onClick:F,color:"secondary",disabled:h.add,children:h.add?t.jsx(ae,{size:24}):d!==null?"Update":"Add"})]})]}),t.jsxs(k,{open:K,onClose:D,children:[t.jsx(I,{children:"Confirm Delete"}),t.jsx(S,{children:"Are you sure you want to delete this item?"}),t.jsxs(O,{children:[t.jsx(u,{onClick:D,color:"secondary",children:"Cancel"}),t.jsx(u,{onClick:Q,color:"error",children:"Confirm"})]})]}),t.jsx(X,{component:E,sx:{marginTop:3},children:t.jsxs(Y,{children:[t.jsx(Z,{children:t.jsx(q,{children:["Item Name","Item Code","Category","Sub-Category","HSN Code","Unit Price","Stock Quantity","Description","Actions"].map(e=>t.jsx(o,{children:e},e))})}),t.jsx(G,{children:Array.isArray(c)&&c.map((e,a)=>t.jsxs(q,{children:[t.jsx(o,{children:e.item_name}),t.jsx(o,{children:e.item_code}),t.jsx(o,{children:e.category_name}),t.jsx(o,{children:e.sub_category_name}),t.jsx(o,{children:e.hsn_code}),t.jsx(o,{children:e.unit_price}),t.jsx(o,{children:e.stock_quantity}),t.jsx(o,{children:e.description}),t.jsxs(o,{children:[t.jsx(L,{color:"secondary",onClick:()=>H(a),children:t.jsx(ee,{})}),t.jsx(L,{color:"error",onClick:()=>N(a),children:t.jsx(te,{})})]})]},a))})]})})]})}export{oe as default};
