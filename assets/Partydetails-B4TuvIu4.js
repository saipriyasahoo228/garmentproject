import{r as t,j as e,J as z,K as u,M as S,O as W,Q as I,S as K,U as l,a6 as H,a7 as J,a8 as Q,a9 as C,V as c,W as A,X,Y as Z,Z as ee,_ as B,$ as s,a0 as ae,a1 as N,a2 as re,a3 as te}from"./index-IJTRt1jI.js";import{a as j}from"./auth-DxPXTuxr.js";import{C as ne}from"./CircularProgress-Ve5gyilg.js";function ie(){const[n,p]=t.useState({party_name:"",gst_number:"",party_type:"",phone:"",email:"",address:"",description:""}),[i,h]=t.useState([]),[m,D]=t.useState({add:!1}),[q,x]=t.useState(!1),[y,b]=t.useState(null),[L,O]=t.useState(null),[V,g]=t.useState(!1),R=t.useRef(null),P=t.useRef(null),$=t.useRef(null),_=t.useRef(null),v=t.useRef(null),w=t.useRef(null),E=t.useRef(null);t.useEffect(()=>{(async()=>{try{const r=await j.get("/api/user/party/");h(r.data.data),alert(r.data.message)}catch(r){console.error("Error fetching items:",r)}})()},[]);const o=a=>{p({...n,[a.target.name]:a.target.value})},F=()=>{x(!0),b(null)},T=()=>{x(!1)},G=async a=>{a.preventDefault(),D({...m,add:!0});try{if(y!==null){const r=await j.put(`/api/user/party/${n.party_name}/`,n),f=[...i];f[y]=r.data,alert(r.data.message),h(f)}else{const r=await j.post("/api/user/party/",n);h([...i,r.data]),alert(r.data.message)}}catch(r){console.error("Error adding/updating party:",r)}finally{D({...m,add:!1}),p({party_name:"",gst_number:"",party_type:"",phone:"",email:"",address:"",description:""}),x(!1)}},M=a=>{p(i[a]),b(a),x(!0)},U=a=>{O(a),g(!0),p(i[a])},Y=async()=>{try{await j.delete(`/api/user/party/${n.party_name}/`,n);const a=i.filter((r,f)=>f!==L);h(a)}catch(a){console.error("Error deleting party:",a)}finally{g(!1)}},k=()=>{g(!1)},d=(a,r)=>{a.key==="Enter"&&r&&(a.preventDefault(),r.current.focus())};return e.jsxs(z,{sx:{maxWidth:"100%",padding:2},children:[e.jsx(u,{variant:"contained",color:"secondary",onClick:F,children:y!==null?"Edit Party":"Add Party"}),e.jsxs(S,{open:q,onClose:T,maxWidth:"md",fullWidth:!0,children:[e.jsx(W,{style:{backgroundColor:"#f9dff5"},children:y!==null?"Edit Party Details":"Add Party Details"}),e.jsx(I,{style:{backgroundColor:"#f9dff5"},children:e.jsx(K,{sx:{padding:"10px",backgroundColor:"#f9dff5"},elevation:0,children:e.jsxs("form",{children:[e.jsxs(l,{container:!0,spacing:2,marginBottom:2,children:[e.jsx(l,{item:!0,xs:6,children:e.jsxs(H,{fullWidth:!0,margin:"normal",required:!0,children:[e.jsx(J,{children:"Party Type"}),e.jsxs(Q,{value:n.party_type,name:"party_type",onChange:o,label:"Party Type",inputRef:$,onKeyDown:a=>d(a,R),children:[e.jsx(C,{value:"Vendor",children:"Vendor"}),e.jsx(C,{value:"Supplier",children:"Supplier"}),e.jsx(C,{value:"Customer",children:"Customer"})]})]})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(c,{fullWidth:!0,label:"Party Name",name:"party_name",value:n.party_name,onChange:o,margin:"normal",required:!0,inputRef:R,onKeyDown:a=>d(a,P)})})]}),e.jsxs(l,{container:!0,spacing:2,marginBottom:2,children:[e.jsx(l,{item:!0,xs:6,children:e.jsx(c,{fullWidth:!0,label:"Party Registration/GST Number",name:"gst_number",value:n.gst_number,onChange:o,margin:"normal",required:!0,inputRef:P,onKeyDown:a=>d(a,_)})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(c,{fullWidth:!0,label:"Phone Number",name:"phone",value:n.phone,onChange:o,margin:"normal",required:!0,inputRef:_,onKeyDown:a=>d(a,v)})})]}),e.jsxs(l,{container:!0,spacing:2,marginBottom:2,children:[e.jsx(l,{item:!0,xs:6,children:e.jsx(c,{fullWidth:!0,label:"Email",name:"email",value:n.email,onChange:o,margin:"normal",required:!0,inputRef:v,onKeyDown:a=>d(a,w)})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(c,{fullWidth:!0,multiline:!0,label:"Address",name:"address",value:n.address,onChange:o,margin:"normal",required:!0,inputRef:w,onKeyDown:a=>d(a,E)})})]}),e.jsx(c,{fullWidth:!0,multiline:!0,rows:3,label:"Description",name:"description",value:n.description,onChange:o,margin:"normal",inputRef:E})]})})}),e.jsxs(A,{style:{backgroundColor:"#f9dff5"},children:[e.jsx(u,{onClick:T,color:"error",children:"Cancel"}),e.jsx(u,{onClick:G,color:"secondary",disabled:m.add,children:m.add?e.jsx(ne,{size:24}):"Submit"})]})]}),e.jsxs(S,{open:V,onClose:k,children:[e.jsx(W,{children:"Confirm Delete"}),e.jsx(I,{children:"Are you sure you want to delete this party?"}),e.jsxs(A,{children:[e.jsx(u,{onClick:k,color:"error",children:"No"}),e.jsx(u,{onClick:Y,color:"secondary",children:"Yes"})]})]}),e.jsx(X,{component:K,sx:{marginTop:2},children:e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsxs(B,{children:[e.jsx(s,{children:"Party Name"}),e.jsx(s,{children:"Party Type"}),e.jsx(s,{children:"Phone"}),e.jsx(s,{children:"Email"}),e.jsx(s,{children:"Actions"})]})}),e.jsx(ae,{children:i.map((a,r)=>e.jsxs(B,{children:[e.jsx(s,{children:a.party_name}),e.jsx(s,{children:a.party_type}),e.jsx(s,{children:a.phone}),e.jsx(s,{children:a.email}),e.jsxs(s,{children:[e.jsx(N,{onClick:()=>M(r),color:"primary",children:e.jsx(re,{})}),e.jsx(N,{onClick:()=>U(r),color:"error",children:e.jsx(te,{})})]})]},a.party_name))})]})})]})}export{ie as default};
