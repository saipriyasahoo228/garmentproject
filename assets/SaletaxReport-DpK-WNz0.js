import{ah as L,ai as z,j as e,r,_ as R,ak as E,V as k,a0 as F,ad as w,af as A,ag as f,a2 as ee,a3 as te,a4 as ae,a5 as I,a6 as s,a7 as re,M as se}from"./index-Dy87SfDR.js";import{E as oe}from"./jspdf.plugin.autotable-C2ZUzCt0.js";import{d as le,T as ne,u as j,w as ie}from"./PictureAsPdf-CwN8_mG7.js";import{d as ce}from"./Description-BV07Z9XD.js";import{C as de}from"./Container-DcIQiiR4.js";import{C as xe}from"./CircularProgress-DR9kP0Ar.js";var _={},pe=z;Object.defineProperty(_,"__esModule",{value:!0});var m=_.default=void 0,ue=pe(L()),he=e;m=_.default=(0,ue.default)((0,he.jsx)("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"}),"ArrowUpward");var S={},ge=z;Object.defineProperty(S,"__esModule",{value:!0});var y=S.default=void 0,fe=ge(L()),je=e;y=S.default=(0,fe.default)((0,je.jsx)("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z"}),"ArrowDownward");const Te=()=>{const[i,B]=r.useState(""),[c,M]=r.useState(""),[o,V]=r.useState(""),[h,W]=r.useState(""),[v,$]=r.useState([]),[d,q]=r.useState([]),[O,b]=r.useState(!1),[g,T]=r.useState(0),[p,N]=r.useState(5),[u,U]=r.useState("asc"),[l,H]=r.useState("total_price"),Y=async()=>{b(!0);try{const a=(await se.post("/api/retailsale/saletax-report/",{start_date:i,end_date:c,tax_type:o})).data.data;$(a)}catch(t){console.error("Error fetching report data:",t)}finally{b(!1)}};r.useEffect(()=>{Y()},[i,c,o]),r.useEffect(()=>{(()=>{const a=new Date(i),n=new Date(c),Q=v.filter(D=>{const P=new Date(D.date),X=(!i||P>=a)&&(!c||P<=n),Z=!o||D.sale_type===o;return X&&Z});q(Q)})()},[i,c,o,v]);const G=()=>{if(d.length===0){alert("No data to export");return}const t=new oe;t.text("Sale Tax Report",14,10),t.autoTable({head:[["Date","Category","Sale Type","Total Price","Total Tax"]],body:d.map(a=>[a.date,a.category,a.sale_type,a.total_price.toFixed(2),a.total_tax.toFixed(2)]),startY:20}),t.save("sale_tax_report.pdf")},J=()=>{if(d.length===0){alert("No data to export");return}const t=j.json_to_sheet(d.map(n=>({Date:n.date,Category:n.category,"Sale Type":n.sale_type,"Total Price":n.total_price.toFixed(2),"Total Tax":n.total_tax.toFixed(2)}))),a=j.book_new();j.book_append_sheet(a,t,"Sale Tax Report"),ie(a,"sale_tax_report.xlsx")},K=t=>{W(t.target.value),t.target.value==="pdf"?G():t.target.value==="excel"&&J()},x=t=>{U(l===t&&u==="asc"?"desc":"asc"),H(t)},C=d.sort((t,a)=>u==="asc"?t[l]>a[l]?1:-1:t[l]<a[l]?1:-1);return e.jsx(de,{maxWidth:"lg",sx:{marginTop:4},children:e.jsxs(R,{elevation:3,sx:{padding:4,backgroundColor:"#f9dff5"},children:[e.jsx(E,{variant:"h4",gutterBottom:!0,align:"center",color:"purple",children:"Sale Tax Report"}),e.jsxs(k,{sx:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:2,marginBottom:3},children:[e.jsx(F,{label:"Start Date",type:"date",value:i,onChange:t=>B(t.target.value),InputLabelProps:{shrink:!0},sx:{minWidth:150}}),e.jsx(F,{label:"End Date",type:"date",value:c,onChange:t=>M(t.target.value),InputLabelProps:{shrink:!0},sx:{minWidth:150}}),e.jsx(w,{sx:{minWidth:150},children:e.jsx(A,{value:o,onChange:t=>V(t.target.value),displayEmpty:!0,renderValue:()=>o||"Select Sale Type",children:e.jsx(f,{value:"RetailSale",children:"Retail Sale"})})}),e.jsx(w,{sx:{minWidth:150},children:e.jsxs(A,{value:h,onChange:K,displayEmpty:!0,renderValue:()=>h||"Export As",children:[e.jsxs(f,{value:"pdf",children:[e.jsx(le,{sx:{marginRight:1,color:"red"}}),"PDF"]}),e.jsxs(f,{value:"excel",children:[e.jsx(ce,{sx:{marginRight:1,color:"green"}}),"Excel"]})]})})]}),O?e.jsx(k,{sx:{display:"flex",justifyContent:"center",marginTop:4},children:e.jsx(xe,{})}):e.jsx(e.Fragment,{children:d.length>0?e.jsxs(e.Fragment,{children:[e.jsx(ee,{component:R,sx:{marginTop:4,backgroundColor:"#f4c4ec"},children:e.jsxs(te,{children:[e.jsx(ae,{children:e.jsxs(I,{children:[e.jsx(s,{onClick:()=>x("date"),sx:{cursor:"pointer",backgroundColor:"#ea8cdb",fontStyle:"bold",color:"purple"},children:e.jsx("strong",{children:"Date"})}),e.jsx(s,{onClick:()=>x("category"),sx:{cursor:"pointer",backgroundColor:"#ea8cdb",fontStyle:"bold",color:"purple"},children:e.jsx("strong",{children:"Category"})}),e.jsx(s,{onClick:()=>x("sale_type"),sx:{cursor:"pointer",backgroundColor:"#ea8cdb",fontStyle:"bold",color:"purple"},children:e.jsx("strong",{children:"Sale Type"})}),e.jsx(s,{onClick:()=>x("total_price"),align:"right",sx:{cursor:"pointer",backgroundColor:"#ea8cdb",fontStyle:"bold",color:"purple"},children:e.jsxs("strong",{children:["Total Price ",l==="total_price"?u==="asc"?e.jsx(m,{fontSize:"small"}):e.jsx(y,{fontSize:"small"}):null]})}),e.jsx(s,{onClick:()=>x("total_tax"),align:"right",sx:{cursor:"pointer",backgroundColor:"#ea8cdb",fontStyle:"bold",color:"purple"},children:e.jsxs("strong",{children:["Total Tax ",l==="total_tax"?u==="asc"?e.jsx(m,{fontSize:"small"}):e.jsx(y,{fontSize:"small"}):null]})})]})}),e.jsx(re,{children:C.slice(g*p,g*p+p).map(t=>e.jsxs(I,{children:[e.jsx(s,{children:t.date}),e.jsx(s,{children:t.category}),e.jsx(s,{children:t.sale_type}),e.jsx(s,{align:"right",children:t.total_price.toFixed(2)}),e.jsx(s,{align:"right",children:t.total_tax.toFixed(2)})]},t.date))})]})}),e.jsx(ne,{rowsPerPageOptions:[5,10,25],component:"div",count:C.length,rowsPerPage:p,page:g,onPageChange:(t,a)=>T(a),onRowsPerPageChange:t=>{N(parseInt(t.target.value,10)),T(0)}})]}):e.jsx(E,{variant:"h6",align:"center",color:"text.secondary",sx:{marginTop:4},children:"No data available for the selected filters."})})]})})};export{Te as default};
