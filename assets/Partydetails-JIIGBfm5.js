import{r as t,j as e,S,U as m,V as N,W,X as I,Y as A,Z as l,ab as Z,ac as J,ad as Q,ae as C,_ as c,$ as K,a0 as ee,a1 as re,a2 as ne,a3 as L,a4 as a,a5 as te,a6 as q,a7 as ae,a8 as se}from"./index-DCAPUvjm.js";import{E as le}from"./jspdf.plugin.autotable-B_ZpTm6Q.js";import{a as j}from"./auth-DxPXTuxr.js";import{D as oe}from"./Download-CKjog-EC.js";import{C as ie}from"./CircularProgress-CtGU9z99.js";function pe(){const[s,h]=t.useState({party_name:"",gst_number:"",registration_number:"",party_type:"",phone:"",email:"",address:"",description:""}),[i,p]=t.useState([]),[x,D]=t.useState({add:!1}),[B,f]=t.useState(!1),[y,R]=t.useState(null),[F,G]=t.useState(null),[O,g]=t.useState(!1),_=t.useRef(null),P=t.useRef(null),V=t.useRef(null),w=t.useRef(null),v=t.useRef(null),b=t.useRef(null),T=t.useRef(null),Y=t.useRef(null);t.useEffect(()=>{(async()=>{try{const n=await j.get("/api/user/party/");p(n.data.data)}catch(n){console.error("Error fetching items:",n)}})()},[]);const o=r=>{h({...s,[r.target.name]:r.target.value})},$=()=>{f(!0),R(null)},k=()=>{f(!1)},U=async r=>{r.preventDefault(),D({...x,add:!0});try{if(y!==null){const n=await j.put(`/api/user/party/${s.party_name}/`,s),u=[...i];u[y]=n.data,alert(n.data.message),p(u)}else{const n=await j.post("/api/user/party/",s);p([...i,n.data]),alert(n.data.message)}}catch(n){console.error("Error adding/updating party:",n)}finally{D({...x,add:!1}),h({party_name:"",gst_number:"",registration_number:"",party_type:"",phone:"",email:"",address:"",description:""}),f(!1)}},z=r=>{h(i[r]),R(r),f(!0)},H=r=>{G(r),g(!0),h(i[r])},M=async()=>{try{await j.delete(`/api/user/party/${s.party_name}/`,s);const r=i.filter((n,u)=>u!==F);p(r)}catch(r){console.error("Error deleting party:",r)}finally{g(!1)}},E=()=>{g(!1)},d=(r,n)=>{r.key==="Enter"&&n&&(r.preventDefault(),n.current.focus())},X=()=>{const r=new le;r.text("Party List Report",14,15),r.autoTable({startY:25,head:[["#","Party Name","Party Type","Phone","Email","GST Number","Registration No.","Address"]],body:i.map((n,u)=>[u+1,n.party_name,n.party_type,n.phone,n.email,n.gst_number,n.registration_number,n.address]),theme:"striped"}),r.save("Party_List.pdf")};return e.jsxs(S,{sx:{maxWidth:"100%",padding:2},children:[e.jsx(m,{variant:"contained",color:"secondary",onClick:$,children:y!==null?"Edit Party":"Add Party"}),e.jsx(S,{sx:{position:"absolute",top:65,right:60},children:e.jsx(m,{variant:"contained",startIcon:e.jsx(oe,{}),onClick:X,sx:{backgroundColor:"#800080",color:"white","&:hover":{backgroundColor:"#6a006a"}},children:"Download PDF"})}),e.jsxs(N,{open:B,onClose:k,maxWidth:"md",fullWidth:!0,children:[e.jsx(W,{style:{backgroundColor:"#f9dff5"},children:y!==null?"Edit Party Details":"Add Party Details"}),e.jsx(I,{style:{backgroundColor:"#f9dff5"},children:e.jsx(A,{sx:{padding:"10px",backgroundColor:"#f9dff5"},elevation:0,children:e.jsxs("form",{children:[e.jsxs(l,{container:!0,spacing:2,marginBottom:2,children:[e.jsx(l,{item:!0,xs:6,children:e.jsxs(Z,{fullWidth:!0,margin:"normal",required:!0,children:[e.jsx(J,{children:"Party Type"}),e.jsxs(Q,{value:s.party_type,name:"party_type",onChange:o,label:"Party Type",inputRef:V,onKeyDown:r=>d(r,_),children:[e.jsx(C,{value:"Vendor",children:"Vendor"}),e.jsx(C,{value:"Supplier",children:"Supplier"}),e.jsx(C,{value:"Customer",children:"Customer"})]})]})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(c,{fullWidth:!0,label:"Party Name",name:"party_name",value:s.party_name,onChange:o,margin:"normal",required:!0,inputRef:_,onKeyDown:r=>d(r,P)})})]}),e.jsxs(l,{container:!0,spacing:2,marginBottom:2,children:[e.jsx(l,{item:!0,xs:6,children:e.jsx(c,{fullWidth:!0,label:"GST Number",name:"gst_number",value:s.gst_number,onChange:o,margin:"normal",required:!0,inputRef:P,onKeyDown:r=>d(r,w)})}),e.jsx(l,{item:!0,xs:6,children:e.jsx(c,{fullWidth:!0,label:"Phone Number",name:"phone",value:s.phone,onChange:o,margin:"normal",required:!0,inputRef:w,onKeyDown:r=>d(r,v)})})]}),e.jsxs(l,{container:!0,spacing:2,marginBottom:2,children:[e.jsxs(l,{item:!0,xs:6,children:[e.jsx(c,{fullWidth:!0,label:"Email",name:"email",value:s.email,onChange:o,margin:"normal",required:!0,inputRef:v,onKeyDown:r=>d(r,b)}),e.jsx(c,{fullWidth:!0,label:"Registration Number",name:"registration_number",value:s.registration_number,onChange:o,margin:"normal",required:!0,inputRef:Y,onKeyDown:r=>d(r,b)})]}),e.jsxs(l,{item:!0,xs:6,children:[e.jsx(c,{fullWidth:!0,multiline:!0,label:"Address",name:"address",value:s.address,onChange:o,margin:"normal",required:!0,inputRef:b,onKeyDown:r=>d(r,T)}),e.jsx(c,{fullWidth:!0,multiline:!0,rows:2,label:"Description",name:"description",value:s.description,onChange:o,margin:"normal",inputRef:T})]})]})]})})}),e.jsxs(K,{style:{backgroundColor:"#f9dff5"},children:[e.jsx(m,{onClick:k,color:"error",children:"Cancel"}),e.jsx(m,{onClick:U,color:"secondary",disabled:x.add,children:x.add?e.jsx(ie,{size:24}):"Submit"})]})]}),e.jsxs(N,{open:O,onClose:E,children:[e.jsx(W,{children:"Confirm Delete"}),e.jsx(I,{children:"Are you sure you want to delete this party?"}),e.jsxs(K,{children:[e.jsx(m,{onClick:E,color:"error",children:"No"}),e.jsx(m,{onClick:M,color:"secondary",children:"Yes"})]})]}),e.jsx(ee,{component:A,sx:{marginTop:2},children:e.jsxs(re,{children:[e.jsx(ne,{children:e.jsxs(L,{children:[e.jsx(a,{children:"Party Name"}),e.jsx(a,{children:"Party Type"}),e.jsx(a,{children:"Phone"}),e.jsx(a,{children:"Email"}),e.jsx(a,{children:"GST Number"}),e.jsx(a,{children:"Registraion No."}),e.jsx(a,{children:"Address"}),e.jsx(a,{children:"Actions"})]})}),e.jsx(te,{children:i.map((r,n)=>e.jsxs(L,{children:[e.jsx(a,{children:r.party_name}),e.jsx(a,{children:r.party_type}),e.jsx(a,{children:r.phone}),e.jsx(a,{children:r.email}),e.jsx(a,{children:r.gst_number}),e.jsx(a,{children:r.registration_number}),e.jsx(a,{children:r.address}),e.jsxs(a,{children:[e.jsx(q,{onClick:()=>z(n),color:"secondary",children:e.jsx(ae,{})}),e.jsx(q,{onClick:()=>H(n),color:"error",children:e.jsx(se,{})})]})]},r.party_name))})]})})]})}export{pe as default};
