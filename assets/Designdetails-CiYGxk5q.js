import{r as t,j as s,J as N,K as g,M as E,O as w,Q as I,S as v,V as D,a5 as P,a6 as z,a7 as H,a8 as J,W as S,X as Q,Y as V,Z as X,_ as R,$ as r,a0 as Y,a1 as T,a2 as Z,a3 as G}from"./index-StUhEbkn.js";import{a as h}from"./auth-DxPXTuxr.js";import{C as ee}from"./CircularProgress-CbqDl7oU.js";function te(){const[o,d]=t.useState({design_name:"",design_code:"",description:"",associated_items:[]}),[i,m]=t.useState([]),[K,L]=t.useState([]),[f,y]=t.useState({add:!1}),[O,x]=t.useState(!1),[c,_]=t.useState(null),[W,C]=t.useState(!1),[b,B]=t.useState(null);t.useEffect(()=>{async function e(){try{const a=await h.get("api/user/designs/");m(a.data.data),alert(a.data.message)}catch(a){console.error("Error fetching designs:",a)}}const n=async()=>{try{const a=await h.get("/api/user/items/");L(a.data.data)}catch(a){console.error("Error fetching categories:",a)}};e(),n()},[]);const l=t.useRef([]),p=e=>{const{name:n,value:a}=e.target;d(n==="associated_items"?u=>({...u,[n]:Array.isArray(a)?a:[a]}):u=>({...u,[n]:a}))},q=()=>{x(!0),_(null),d({design_name:"",design_code:"",description:"",associated_items:[]})},A=()=>{x(!1)},U=async e=>{e.preventDefault(),y({...f,add:!0});try{if(c!==null){const n=await h.put(`api/user/designs/${o.design_code}/`,o),a=[...i];a[c]=n.data,m(a),console.log("Updated",n.data),alert(n.data.message)}else{const n=await h.post("api/user/designs/",o);m([...i,n.data]),console.log("Added",n.data),alert(n.data.message)}}catch(n){console.error("Error saving design:",n),alert(n)}finally{y({...f,add:!1}),x(!1)}},$=e=>{d(i[e]),_(e),x(!0)},F=e=>{B(e),C(!0),d(i[e])},M=async()=>{try{const e=await h.delete(`api/user/designs/${o.design_code}`,o),n=i.filter((a,u)=>u!==b);m(n),console.log("Deleted design at index",b),alert(e.data.message)}catch(e){console.error("Error deleting design:",e)}finally{C(!1)}},k=()=>{C(!1)},j=(e,n)=>{if(e.key==="Enter"){e.preventDefault();const a=n+1;l.current[a]&&l.current[a].focus()}};return s.jsxs(N,{sx:{maxWidth:"100%",padding:2},children:[s.jsx(g,{variant:"contained",color:"secondary",onClick:q,children:c!==null?"Edit Design":"Add Design"}),s.jsxs(E,{open:O,onClose:A,children:[s.jsx(w,{style:{backgroundColor:"#f9dff5"},children:c!==null?"Edit Design Details":"Add Design Details"}),s.jsx(I,{style:{backgroundColor:"#f9dff5"},children:s.jsx(v,{sx:{padding:"10px",backgroundColor:"#f9dff5"},elevation:0,children:s.jsxs("form",{children:[s.jsx(D,{fullWidth:!0,label:"Design Name",name:"design_name",value:o.design_name,onChange:p,margin:"normal",required:!0,inputRef:e=>l.current[0]=e,onKeyDown:e=>j(e,0)}),s.jsx(D,{fullWidth:!0,label:"Design Code",name:"design_code",value:o.design_code,onChange:p,margin:"normal",required:!0,inputRef:e=>l.current[1]=e,onKeyDown:e=>j(e,1)}),s.jsxs(P,{fullWidth:!0,margin:"normal",required:!0,children:[s.jsx(z,{children:"Associated Items"}),s.jsx(H,{multiple:!0,value:o.associated_items||[],name:"associated_items",onChange:p,label:"Associated Items",inputRef:e=>l.current[2]=e,onKeyDown:e=>j(e,2),children:K.map(e=>s.jsx(J,{value:e.item_name,children:e.item_name},e.id))})]}),s.jsx(D,{fullWidth:!0,multiline:!0,rows:4,label:"Description",name:"description",value:o.description,onChange:p,margin:"normal",inputRef:e=>l.current[3]=e,onKeyDown:e=>j(e,3)})]})})}),s.jsxs(S,{style:{backgroundColor:"#f9dff5"},children:[s.jsx(g,{onClick:A,color:"error",children:"Cancel"}),s.jsx(g,{onClick:U,color:"secondary",disabled:f.add,children:f.add?s.jsx(ee,{size:24}):c!==null?"Update":"Add"})]})]}),s.jsxs(E,{open:W,onClose:k,children:[s.jsx(w,{children:"Delete Confirmation"}),s.jsx(I,{children:"Are you sure to delete?"}),s.jsxs(S,{children:[s.jsx(g,{onClick:k,color:"secondary",children:"Cancel"}),s.jsx(g,{onClick:M,color:"error",children:"Confirm"})]})]}),s.jsx(Q,{component:v,sx:{marginTop:3},children:s.jsxs(V,{children:[s.jsx(X,{children:s.jsxs(R,{children:[s.jsx(r,{children:"Design Name"}),s.jsx(r,{children:"Design Code"}),s.jsx(r,{children:"Associated Items"}),s.jsx(r,{children:"Description"}),s.jsx(r,{children:"Actions"})]})}),s.jsx(Y,{children:i.map((e,n)=>s.jsxs(R,{children:[s.jsx(r,{children:e.design_name}),s.jsx(r,{children:e.design_code}),s.jsx(r,{children:Array.isArray(e.associated_items)?e.associated_items.join(", "):e.associated_items}),s.jsx(r,{children:e.description}),s.jsxs(r,{children:[s.jsx(T,{color:"secondary",onClick:()=>$(n),children:s.jsx(Z,{})}),s.jsx(T,{color:"error",onClick:()=>F(n),children:s.jsx(G,{})})]})]},n))})]})})]})}export{te as default};
